<div id="titan-memory-settings">
    <!-- Header -->
    <div class="inline-drawer">
        <div class="inline-drawer-toggle inline-drawer-header">
            <b>Titan Memory Configuration</b>
            <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
        </div>
        <div class="inline-drawer-content">
            
            <!-- Main Toggles -->
            <div class="flex-container align-items-center justify-content-space-between">
                <label data-i18n="Enabled">Enabled</label>
                <input type="checkbox" id="titan-enabled" />
            </div>
            <div class="flex-container align-items-center justify-content-space-between">
                <label data-i18n="Debug Mode">Debug Mode</label>
                <input type="checkbox" id="titan-debug" />
            </div>
            <div class="flex-container align-items-center justify-content-space-between">
                <label>Show "Success" Popups</label>
                <input type="checkbox" id="titan-show-toasts" />
            </div>

            <hr>

            <!-- Aggressive Pruning Section -->
            <h3>üõë Aggressive Pruning</h3>
            <div class="flex-container align-items-center justify-content-space-between">
                <label title="If enabled, messages are hidden to keep history under a strict token limit.">Enable Token Budgeting</label>
                <input type="checkbox" id="titan-pruning" />
            </div>
            <div class="flex-container align-items-center justify-content-space-between">
                <label title="Max tokens to keep in chat history (excluding summary). Older messages are pruned.">Target Context Budget (Tokens)</label>
                <input type="number" id="titan-token-budget" class="text_pole" min="100" max="10000" placeholder="1000" />
            </div>

            <hr>

            <!-- Summarization Settings -->
            <h3>üìù Summarization</h3>
            <div class="flex-container align-items-center justify-content-space-between">
                <label>Auto-Summarize</label>
                <input type="checkbox" id="titan-auto-summarize" />
            </div>
            <div class="flex-container align-items-center justify-content-space-between">
                <label title="Number of new messages before triggering summary.">Message Threshold</label>
                <input type="number" id="titan-threshold" class="text_pole" min="1" max="20" />
            </div>
             <div class="flex-container align-items-center justify-content-space-between">
                <label title="Max length of the generated summary (Characters).">Max Summary Length</label>
                <input type="number" id="titan-max-length" class="text_pole" min="100" max="5000" />
            </div>

            <hr>

            <!-- Lorebook Integration -->
            <h3>üìñ Lorebook Sync</h3>
            <div class="flex-container align-items-center justify-content-space-between">
                <label title="Automatically save the summary to a Lorebook entry with dynamic keywords.">Sync Summary to Lorebook</label>
                <input type="checkbox" id="titan-lorebook-sync" />
            </div>
            <div class="flex-container align-items-center justify-content-space-between">
                <label title="Inject the summary into the prompt normally (Extension Prompt). Disable this if using Lorebook Sync to save tokens!">Inject Summary in Prompt</label>
                <input type="checkbox" id="titan-inject-prompt" />
            </div>

            <hr>

            <!-- RAG / Vector Memory -->
            <h3>üß† Vector Memory (RAG)</h3>
            <div class="flex-container align-items-center justify-content-space-between">
                <label title="Turn old messages into vectors and retrieve them when relevant.">Enable Vector Recall</label>
                <input type="checkbox" id="titan-rag-enabled" />
            </div>
            
            <div class="flex-container align-items-center justify-content-space-between">
                <label>Embedding API URL</label>
                <input type="text" id="titan-rag-url" class="text_pole" placeholder="https://api.openai.com/v1/embeddings" />
            </div>
            <div class="flex-container align-items-center justify-content-space-between">
                <label>Embedding API Key</label>
                <input type="password" id="titan-rag-key" class="text_pole" placeholder="sk-..." />
            </div>
            <div class="flex-container align-items-center justify-content-space-between">
                <label title="How many past memories to retrieve per generation.">Retrieval Depth</label>
                <input type="number" id="titan-rag-depth" class="text_pole" min="1" max="10" placeholder="3" />
            </div>

            <hr>

            <!-- Controls -->
            <div class="flex-container justify-content-center">
                 <button id="titan-view-history" class="menu_button">
                    <i class="fa-solid fa-clock-rotate-left"></i> View History
                </button>
                <button id="titan-save" class="menu_button" title="Save changes manually">
                    <i class="fa-solid fa-save"></i> Save
                </button>
                <button id="titan-now" class="menu_button" title="Force Summarize Now">
                    <i class="fa-solid fa-bolt"></i> Run Now
                </button>
                <button id="titan-wipe" class="menu_button red_button" title="Wipe Memory">
                    <i class="fa-solid fa-trash"></i> Wipe
                </button>
            </div>
            
            <!-- Prompt Template -->
            <div style="margin-top: 10px;">
                <label>Summary Prompt Template</label>
                <textarea id="titan-prompt-template" class="text_pole" rows="6"></textarea>
                <button id="titan-reset-prompt" class="menu_button">Reset Prompt</button>
            </div>

        </div>
    </div>
</div>
